<dom-module id="ext-element">
  <template extends="parent-element">
    <h1>Hello World</h1>
  </template>
  <script type="text/javascript" src="../node_modules/swig/dist/swig.min.js"/>
  </script>
  <script>
    swig.setDefaults({
      varControls: ['[:', ':]']
    });

    function swigTemplate(template, locals) {
      var output = swig.render(template, {
        locals: locals
      });
      output = output.replace(':{{', '{{').replace('}}:', '}}');
      return output;
    }

    var locals = {
        pagename: 'awesome people',
        authors: ['Paul', 'Jim', 'Jane']
    };

    var parentElement = Polymer.findRegistered('parent-element');
    var extElem = Polymer.extend({
      parent: parentElement,
      // properties: parentElement.properties,
      // props: parentElement.props,
      // behaviors: parentElement.methods
    }, {
      is: 'ext-element',
      properties: {
        subTitle: {
          type: String,
          default: 'hi there'
        }
      },
      templator: function(template) {
        if (template) {
          template = template.cloneNode();
          var parent = template.getAttribute('extends');
          var parentTemplate = Polymer.DomModule.import(parent, 'template');
          // var fragment = parentTemplate.content;
          var engine = parentTemplate.getAttribute('engine');
          if (engine == 'swig') {
            var templateContent = parentTemplate.innerHTML;
            var output = swigTemplate(templateContent, locals);
            template.innerHTML = output
          }
        }

        this._template = template;
      }
    });

    console.log('extension', extElem);
    Polymer(extElem);
    var myExt = Polymer.findRegistered('ext-element');
    console.log('template', extElem._template);
    console.log('my-ext', extElem);
  </script>
<dom-module>